<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.douzone.timeattendance.mapper.UserMapper">
    <select id="findByUserEmail" parameterType="String" resultType="User">
        SELECT *
        FROM User
        WHERE email = #{email}
    </select>
    <select id="findByNotDistributed" resultType="com.douzone.timeattendance.dto.UserResponseDto">
        SELECT u.user_id as id, u.name, u.position, u.email, u.hire_date, d.name as department
        FROM User u
                 LEFT JOIN dept d ON u.dept_id = d.dept_id
        WHERE u.distribution = 0;
    </select>
    <select id="findByDistributed" resultType="com.douzone.timeattendance.dto.UserResponseDto">
        SELECT u.user_id as id, u.name, u.position, u.email, u.hire_date, d.name as department
        FROM User u
                 LEFT JOIN dept d ON u.dept_id = d.dept_id
        WHERE u.distribution = 1;
    </select>
    <select id="countUsersByWorkGroupId" parameterType="Long" resultType="Integer">
        SELECT COUNT(*)
        FROM User
        WHERE work_group_id = #{workGroupId}
    </select>
    <insert id="insertUser" parameterType="User">
        INSERT INTO User(name, email, password, phone, hire_date, birthday, position, gender, distribution,
                         date_created, date_updated, date_deleted, is_deleted, is_admin, work_group_id, company_id,
                         dept_id)
        VALUES (#{name}, #{email}, #{password}, #{phone}, #{hire_date}, #{birthday}, #{position}, #{gender},
                #{distribution}, #{date_created}, #{date_updated}, #{date_deleted}, #{is_deleted}, #{is_admin},
                #{work_group_id}, #{company_id}, #{dept_id})
    </insert>
</mapper>